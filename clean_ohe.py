from clean_data import read_data_two, load
import pandas as pd
import numpy as np

import lightgbm as lgb
import time
import gc

import joblib

from sklearn.model_selection import train_test_split
from sklearn.metrics import (roc_curve, auc, accuracy_score)
from sklearn.model_selection import GridSearchCV

train = pd.read_csv('input/train_ohe.csv', usecols=load)
test = pd.read_csv('input/test_ohe.csv', usecols=load)

train.drop('Unnamed: 0', axis=1, inplace=True)
test.drop('Unnamed: 0', axis=1, inplace=True)

rows = len(train)
a = train.astype(bool).sum(axis=0) / rows

toDrop = []
for col in a.index:
    if a[col] > 0.95:
        toDrop.append(col)

train.drop(toDrop, axis=1, inplace=True)
test.drop(toDrop, axis=1, inplace=True)

train.to_csv('input/train_ohe_dropped.csv', index=False)
test.to_csv('input/test_ohe_dropped.csv', index=False)